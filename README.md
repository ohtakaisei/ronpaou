# Devil's Advocate メーカー（悪魔の代弁者メーカー）

あなたの意見に**あえて反論**し、思考を深めるAIアシスタントです。

Web検索で根拠を集めながら、選んだペルソナのキャラクターで多角的な反論を生成します。「自分の考えに穴はないか？」「見落としている視点はないか？」を確認したいときに使えます。

---

## どんなアプリ？

ユーザーが入力した意見・主張・企画書に対し、AIが「悪魔の代弁者」として反対意見を返します。

単なる否定ではなく、DuckDuckGoでリアルタイムにWeb検索を行い、**データや事例に基づいた建設的な反論**を生成するのが特徴です。

### 使用例

| やりたいこと | 使い方 |
|---|---|
| 自分の意見の死角を知りたい | 「再生可能エネルギーは原子力より安全だ」→ 検索付きの反論が返る |
| 企画書の弱点を事前にチェックしたい | 企画書テキストを貼り付け → Q&A形式で想定質問が返る |
| ある主張を多角的に検証したい | 自由に意見を入力 → 3〜5つの異なる視点からの反論が返る |

---

## 3つのモード

| モード | 概要 | 検索 | 出力形式 |
|---|---|---|---|
| **フィルターバブル破壊** | ユーザーの主張の反対側から反論 | 必須（日英両方） | 反論サマリー + 根拠 + 別の視点 |
| **企画書の穴埋め** | 企画書の弱点を鋭く指摘 | 任意 | 想定質問（5〜7問）+ 最大リスク |
| **自由討論** | 多角的な視点から反論 | 任意 | 3〜5視点の反論 + 建設的な提案 |

## 3つのペルソナ

| ペルソナ | キャラクター |
|---|---|
| **辛口批評家** | 歯に衣着せぬ批評スタイル。論理の飛躍や根拠の弱さを容赦なく指摘する |
| **慎重派投資家** | ROI・市場データ・競合分析の観点から冷静に評価する |
| **リスク管理専門家** | 最悪のシナリオを常に想定し、リスクを徹底的に洗い出す |

モード × ペルソナの組み合わせ（3×3＝9パターン）で、さまざまな角度の反論を得られます。

---

## 仕組み（アーキテクチャ）

```
ユーザーの入力
    ↓
[Thought]  LLMがキーワード抽出・検索計画を立案
    ↓
[Action]   DuckDuckGo検索（日本語/英語クエリ）
    ↓
[Observation] 検索結果をエージェントに返却
    ↓
[Thought]  結果を評価、追加検索が必要か判断
    ↓        （必要に応じてループ）
[Final Answer] 構造化された反論を出力
```

LangChainの**ReActエージェント**パターンを採用しています。LLMが自律的に「考える→検索する→結果を評価する」を繰り返し、十分な根拠が集まった時点で最終回答を生成します。

---

## 技術スタック

| 項目 | 技術 |
|---|---|
| UI | Streamlit（日本語） |
| LLM | Google Gemini API（`gemini-2.0-flash`） |
| Web検索 | DuckDuckGo（APIキー不要） |
| エージェント | LangChain ReAct Agent |

---

## セットアップ

### 前提条件

- Python 3.10以上
- [Google AI Studio](https://aistudio.google.com/) のAPIキー

### インストール

```bash
# リポジトリをクローン
git clone <repository-url>
cd ronpaou

# 仮想環境の作成・有効化
python3 -m venv .venv
source .venv/bin/activate

# 依存パッケージのインストール
pip install -r requirements.txt
```

### 起動

```bash
streamlit run app.py
```

ブラウザが自動で開きます（デフォルト: http://localhost:8501）。サイドバーにAPIキーを入力すれば使い始められます。

---

## プロジェクト構成

```
ronpaou/
├── app.py              # Streamlit UI（メインエントリポイント）
├── agent.py            # ReActエージェント構築・実行
├── prompts.py          # プロンプトテンプレート（ペルソナ × モード）
├── tools.py            # DuckDuckGo検索ツール設定
├── config.py           # 定数・UI文字列・設定値
└── requirements.txt    # 依存パッケージ
```

| ファイル | 役割 |
|---|---|
| `app.py` | Streamlit UIの描画、ユーザー入力の受付、チャット履歴管理、エラーハンドリング |
| `agent.py` | Gemini LLMの初期化、ReActエージェントの作成・実行、中間ステップの返却 |
| `prompts.py` | 3ペルソナ × 3モードのプロンプトテンプレート定義と動的合成 |
| `tools.py` | DuckDuckGo検索ツールの設定（日本語リージョン） |
| `config.py` | モード/ペルソナのID・ラベル・説明文、UI文字列、エラーメッセージ等の定数 |
